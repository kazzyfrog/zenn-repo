---
title: "Next.js 14.1 ã‚’ GitHub Pages ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã‚¬ã‚¤ãƒ‰"
emoji: "ğŸ±"
type: "tech"
topics:
  - "nextjs"
  - "vercel"
  - "githubactions"
  - "githubpages"
  - "åˆå¿ƒè€…å‘ã‘"
published: true
published_at: "2024-03-25 08:31"
---

Next.jsã§ä½œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€
GitHub Actionsã‚’ä½¿ã£ã¦ã€GitHubä¸Šã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã®è¨˜äº‹ã§ã¯ã€**GitHub Pagesã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸæ‰‹é †ã¨ã€é­é‡ã—ãŸã‚¨ãƒ©ãƒ¼ã«ã¤ã„ã¦ã¾ã¨ã‚ã¾ã—ãŸï¼**

æ¤œè¨¼ç’°å¢ƒï¼š
ãƒ»Next.js v14.1.3/ App Router

vercelã®ç„¡æ–™æ ã¯ã€**æ¥ç¶šå¯èƒ½ãªGitHubãƒªãƒã‚¸ãƒˆãƒªã®æ•°ãŒï¼“ã¤ã¾ã§**ãªã®ã§ã€æŸ”è»Ÿã«ä½¿ã„åˆ†ã‘ã§ãã‚‹ã¨è‰¯ã•ãã†ã§ã™ã­ï¼

## 1ï¼šNext.js/App Routerãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
ã¾ãšã¯ã€å…¬å¼ã®[installation](https://nextjs.org/docs/getting-started/installation)ã«å¾“ã„ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§Next.jsã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```
npx create-next-app@latest
```

ä»Šå›ã¯ã€App Routerã‚’ä½¿ç”¨ã—ã€
è³ªå•ã¸ã®å›ç­”ã¯ã™ã¹ã¦ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã¾ã¾é€²ã¿ã¾ã™ã€‚

## 2ï¼šGitHub Pagesã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã«å¿…è¦ãªå¤‰æ›´ã‚’åŠ ãˆã‚‹

GitHubã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹å‰ã«ã€ï¼’ã¤å¤‰æ›´ã‚’åŠ ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼

### â‘ nextConfigãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´

**Next.js v14.1.3ã§ã¯ã€`create-next-app`ã—ãŸã‚‰ã€
è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€`next.config.mjs`ã«ãªã£ã¦ã„ã‚‹ã¯ãšã§ã™ã€‚**

nextConfigã«ã€[é™çš„ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ](https://nextjs.org/docs/app/building-your-application/deploying/static-exports)ã®è¨­å®šã‚’è¨˜è¿°ã—ã¾ã™ï¼

```diff ts:next.config.mjs
/**
 * @type {import('next').NextConfig}
 */
const nextConfig = {
+ output: "export",
}

export default nextConfig
```

:::details ãƒã‚¤ãƒ³ãƒˆï¼šã‚‚ã— next.config.js ã‚’ä½¿ã†å ´åˆ
nextConfigã®è¨­å®šã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼
```ts:next.config.js
/** @type {import('next').NextConfig} */
const nextConfig = {
  output: "export",
}

module.exports = nextConfig
```
è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒã€`next.config.js`ã‹ã€`next.config.mjs`ã‹ã«ã‚ˆã£ã¦ã€
å¾Œè¿°ã™ã‚‹å¤‰æ›´ãŒç•°ãªã‚‹ã®ã§æ³¨æ„ã—ã¦ãã ã•ã„ï¼

**è‡ªåˆ†ã¯ã€ã“ã‚Œã«è©°ã¾ã‚Šã¾ã—ãŸã€‚ã€‚**

ç‰¹ã«ç†ç”±ãŒãªã‘ã‚Œã°ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®`next.config.mjs`ã§OKã ã¨æ€ã„ã¾ã™ï¼
:::

**ã“ã‚Œã«ã‚ˆã‚Šã€`next build`ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€
`./out`ãƒ•ã‚©ãƒ«ãƒ€ãŒç”Ÿæˆã•ã‚Œã€é™çš„ã‚µã‚¤ãƒˆãŒå‡ºåŠ›ã•ã‚Œã¾ã™ï¼**

#### ãƒ¡ãƒ¢ï¼šnext exportã¯éæ¨å¥¨â†’å‰Šé™¤
ã¡ãªã¿ã«ã€
ä»¥å‰ã®Pages Routerã§ã¯é™çš„ã‚µã‚¤ãƒˆã‚’å‡ºåŠ›ã™ã‚‹ã«ã¯ `next export`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚

ã“ã‚Œã¯ã€v13.3.0ã§éæ¨å¥¨ã«ãªã‚Šã€nextConfigã«`output: "export"`ã®è¨˜è¿°ã‚’ã™ã‚‹æ–¹æ³•ã«ç½®ãæ›ã‚ã‚Šã¾ã—ãŸã€‚
ãã—ã¦ã€v14.0.0ã«ã¦ã€`next export`ã¯å‰Šé™¤ã•ã‚Œã¦ã„ã¾ã™ï¼

è©³ã—ãã¯ã€ä¸‹è¨˜ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã¦ãã ã•ã„ï¼š
https://nextjs.org/docs/app/building-your-application/deploying/static-exports#version-history



### â‘¡Imageã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«basePathã®è¨­å®šã‚’è¨˜è¼‰ã™ã‚‹

GitHub Pagesã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹å ´åˆã€URLã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š
`https://[ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå].github.io/[ãƒªãƒã‚¸ãƒˆãƒªå]/`

ã“ã®ã‚ˆã†ãªURLã®å ´åˆã€Next.jsã§ã€`basePath`ã®è¨­å®šã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ï¼

https://nextjs.org/docs/app/api-reference/next-config-js/basePath
> ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã‚µãƒ–ãƒ‘ã‚¹ã®ä¸‹ã«Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã«ã¯ã€basePathè¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚

å®Ÿã¯ã€**å¾Œè¿°ã™ã‚‹GitHub Actionsã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã§ã€
`basePath`ã‚’`nextConfig`å†…ã«ã€è‡ªå‹•ã§è¿½åŠ ã™ã‚‹å‡¦ç†ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚**

ãªã®ã§ã€ä»Šå›ã¯è‡ªåˆ†ã§`nextConfig`å†…ã«ã€`basePath`ã‚’è¨­å®šã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ï¼

ãŸã ã—ã€[Imageã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ](https://nextjs.org/docs/app/api-reference/next-config-js/basePath#images)ã¯ã€
ä¸Šè¨˜ã®`nextConfig`å†…ã®è¨­å®šã¨ã¯åˆ¥ã§ã€srcå±æ€§ã«`basePath`ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

app/page.tsxå†…ã§ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹Imageã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã€ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã¾ã™ï¼

```diff jsx
import Image from 'next/image'

+ import nextConfig from "../../next.config.mjs";
+ const BASE_PATH = nextConfig.basePath || "";

    ...
    <Image
+     src={`${BASE_PATH}/vercel.svg`}
      alt="Vercel Logo"
      className="dark:invert"
      width={100}
      height={24}
      priority
    />
    ...
    <Image
      className="relative dark:drop-shadow-[0_0_0.3rem_#ffffff70] dark:invert"
+     src={`${BASE_PATH}/next.svg`}
      alt="Next.js Logo"
      width={180}
      height={37}
      priority
    />

```

:::details ãƒã‚¤ãƒ³ãƒˆï¼šã‚‚ã— next.config.js ã‚’ä½¿ã†å ´åˆ
ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã‚’ã€`next.config.js`ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«åˆã‚ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼
```jsx
import nextConfig from "../../next.config.mjs";
const BASE_PATH = nextConfig.basePath || "";
```
â†“
```jsx
import { basePath } from "../../next.config.js";
const BASE_PATH = basePath || "";
```
:::

**ã“ã‚Œã«ã‚ˆã£ã¦ã€Imageã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ã£ãŸç”»åƒãŒã€é©åˆ‡ã«æä¾›ã•ã‚Œã¾ã™ï¼**

## 3:GitHubä¸Šã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹
ã“ã‚Œã«é–¢ã—ã¦ã¯ã€ãã®ã¾ã¾ã§ã™ã­ï¼
ã‚³ãƒŸãƒƒãƒˆã—ã¦ã€GitHubä¸Šã«ãƒ—ãƒƒã‚·ãƒ¥ã—ã¾ã™ï¼

GitHub Actionsã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«é–¢ã—ã¦ã¯ã€GitHubä¸Šã§å°å…¥ãƒ»ç·¨é›†ã§ãã¾ã™ï¼


## 4:GitHub Actionsã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å°å…¥ãƒ»ç·¨é›†

GitHub Pagesã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã«ã‚ãŸã£ã¦ã€
**å…¬å¼ã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ã‚‹ã€Next.jsç”¨ã®GitHub Actionsã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’åˆ©ç”¨ã§ãã¾ã™**ï¼

ã“ã‚Œã«ã‚ˆã£ã¦ã€`main`ãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã‚’ãƒˆãƒªã‚¬ãƒ¼ã«ã€
ãƒ“ãƒ«ãƒ‰ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã€è‡ªå‹•åŒ–ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ï¼

ä»¥ä¸‹ã®ç”»åƒã®ã‚ˆã†ã«ã€ãƒªãƒã‚¸ãƒˆãƒªã®ç”»é¢ã‹ã‚‰ã€
Settings > Pages > Next.jsãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã€ŒConfigureã€ã¨é€²ã¿ã¾ã™ï¼š

![](https://storage.googleapis.com/zenn-user-upload/ca2d5bcb6bf8-20240325.png)

ã™ã‚‹ã¨ã€Next.jsç”¨ã®GitHub Actionsã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«(nextjs.yml)ã®ã€ç·¨é›†ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

**ã“ã‚Œã¯ã€ç¾æ™‚ç‚¹ï¼ˆ2024/03/25ï¼‰ã§ã¯ã€æœ€æ–°ã®Next.jsã«åˆã‚ã›ã¦æ›´æ–°ã•ã‚Œã¦ã„ãªã„ã®ã§ã€
å°‘ã—å¤‰æ›´ã‚’åŠ ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼**

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®é€šã‚Š`next.config.mjs`ã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆã€
ä»¥ä¸‹ã®ã‚ˆã†ã«ã€ãƒã‚¤ãƒ©ã‚¤ãƒˆã•ã‚Œã¦ã„ã‚‹ï¼’ç®‡æ‰€ã‚’æ›¸ãæ›ãˆã¦ã€ã‚³ãƒŸãƒƒãƒˆã—ã¾ã™ï¼

```diff yml
# Sample workflow for building and deploying a Next.js site to GitHub Pages
#
# To get started with Next.js see: https://nextjs.org/docs/getting-started
#
name: Deploy Next.js site to Pages

on:
  # Runs on pushes targeting the default branch
  push:
    branches: ["main"]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: read
  pages: write
  id-token: write

# Allow only one concurrent deployment, skipping runs queued between the run in-progress and latest queued.
# However, do NOT cancel in-progress runs as we want to allow these production deployments to complete.
concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  # Build job
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Detect package manager
        id: detect-package-manager
        run: |
          if [ -f "${{ github.workspace }}/yarn.lock" ]; then
            echo "manager=yarn" >> $GITHUB_OUTPUT
            echo "command=install" >> $GITHUB_OUTPUT
            echo "runner=yarn" >> $GITHUB_OUTPUT
            exit 0
          elif [ -f "${{ github.workspace }}/package.json" ]; then
            echo "manager=npm" >> $GITHUB_OUTPUT
            echo "command=ci" >> $GITHUB_OUTPUT
            echo "runner=npx --no-install" >> $GITHUB_OUTPUT
            exit 0
          else
            echo "Unable to determine package manager"
            exit 1
          fi
      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: "20"
          cache: ${{ steps.detect-package-manager.outputs.manager }}
      - name: Setup Pages
        uses: actions/configure-pages@v4
        with:
          # Automatically inject basePath in your Next.js configuration file and disable
          # server side image optimization (https://nextjs.org/docs/api-reference/next/image#unoptimized).
          #
          # You may remove this line if you want to manage the configuration yourself.
          static_site_generator: next
+         generator_config_file: next.config.mjs
      - name: Restore cache
        uses: actions/cache@v4
        with:
          path: |
            .next/cache
          # Generate a new cache whenever packages or source files change.
          key: ${{ runner.os }}-nextjs-${{ hashFiles('**/package-lock.json', '**/yarn.lock') }}-${{ hashFiles('**.[jt]s', '**.[jt]sx') }}
          # If source files changed but packages didn't, rebuild from a prior cache.
          restore-keys: |
            ${{ runner.os }}-nextjs-${{ hashFiles('**/package-lock.json', '**/yarn.lock') }}-
      - name: Install dependencies
        run: ${{ steps.detect-package-manager.outputs.manager }} ${{ steps.detect-package-manager.outputs.command }}
      - name: Build with Next.js
        run: ${{ steps.detect-package-manager.outputs.runner }} next build
-     # - name: Static HTML export with Next.js
-     #   run: ${{ steps.detect-package-manager.outputs.runner }} next export
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./out

  # Deployment job
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
```
**ã‚‚ã—ã€`next.config.js`ã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆã¯ã€
ä¸‹è¨˜ã®ã€Œï¼‘ã¤ç›®ã®å¤‰æ›´ã€ã‚’åŠ ãˆã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ï¼**

### å¤‰æ›´ç‚¹â‘ ï¼šgenerator_config_file: next.config.mjs
`Setup Pages`ã®ä¸­ã«ã€
`generator_config_file: next.config.mjs`ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ï¼

```diff yml
      - name: Setup Pages
        uses: actions/configure-pages@v4
        with:
          # Automatically inject basePath in your Next.js configuration file and disable
          # server side image optimization (https://nextjs.org/docs/api-reference/next/image#unoptimized).
          #
          # You may remove this line if you want to manage the configuration yourself.
          static_site_generator: next
+         generator_config_file: next.config.mjs
```
**ã“ã®ã€`Setup Pages`ã«ã¯ã€`basePath`ã‚’`nextConfig`å†…ã«ã€è‡ªå‹•ã§è¿½åŠ ã™ã‚‹å‡¦ç†ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚**

ã¤ã¾ã‚Šã€ã“ã“ã®éƒ¨åˆ†ã§ã€
å®Ÿéš›ã®ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆã®URL`https://[ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå].github.io/[ãƒªãƒã‚¸ãƒˆãƒªå]/`ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ï¼

**ãã®éš›ã€æ³¨æ„ã™ã¹ããƒã‚¤ãƒ³ãƒˆãŒã€`generator_config_file: next.config.mjs`ã‚’æŒ‡å®šã—ãªã„å ´åˆã€
æ¨™æº–ã§`next.config.js`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦æ¤œå‡ºã™ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™**ã€‚

`next.config.mjs`ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã®ã«ã€ä¸Šè¨˜ã®è¨˜è¼‰ã‚’è¿½åŠ ã—ãªã„å ´åˆã€
`next.config.js`ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ–°ãŸã«ä½œæˆã•ã‚Œã¦ã—ã¾ã„ã€ã‚¨ãƒ©ãƒ¼ãŒã‚¹ãƒ­ãƒ¼ã•ã‚Œã¾ã™ï¼

### å¤‰æ›´ç‚¹â‘¡ï¼šnext export
å…ˆè¿°ã—ãŸé€šã‚Šã€App Routerã§ã¯`next export`ã‚³ãƒãƒ³ãƒ‰ãŒä¸è¦ãªãŸã‚ã€ã“ã®ï¼’è¡Œã¯å‰Šé™¤ or ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¾ã™ï¼
```diff yml
-     # - name: Static HTML export with Next.js
-     #   run: ${{ steps.detect-package-manager.outputs.runner }} next export
```

## 5:GitHub Pagesã«ãƒ‡ãƒ—ãƒ­ã‚¤ğŸš€
`main`ãƒ–ãƒ©ãƒ³ãƒã¸ã‚³ãƒŸãƒƒãƒˆã‚’è¡Œã†ã¨ã€è‡ªå‹•çš„ã«GitHub ActionsãŒä½œå‹•ã™ã‚‹ã®ã§ã€
ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Œäº†ã™ã‚‹ã®ã‚’å°‘ã—å¾…ã£ãŸã‚‰ã€å®Œäº†ã«ãªã‚Šã¾ã™ğŸ‘

<br>

## è©°ã¾ã£ãŸãƒã‚¤ãƒ³ãƒˆï¼‰Error: Process completed with exit code 2.

Github Actionsã®ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹éš›ã«ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ã«é­é‡ã—ã¾ã—ãŸï¼š

```
Run actions/upload-pages-artifact@v3
Run echo ::group::Archive artifact
Archive artifact
  tar: out: Cannot open: No such file or directory
  tar: Error is not recoverable: exiting now
  Error: Process completed with exit code 2.
```

ã“ã®ã‚¨ãƒ©ãƒ¼ã®å†…å®¹ã¯ã€
./out ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆé™çš„ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã•ã‚ŒãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã€ã¨ã„ã†ã“ã¨ã§ã™ã€‚
ã¤ã¾ã‚Šã€`next.config.mjs`ã«è¨˜è¿°ã—ãŸã€`output: 'export',`ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ãªã„ã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

çµè«–ã¨ã—ã¦ã€**ã“ã‚Œã¯ã€Github Actions ãƒ†ãƒ³ãƒ—ãƒ¬ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®`Setup Pages`ãŒåŸå› ã§ã—ãŸã€‚ã€‚**

ãã®`Setup Pages`ã®ç®‡æ‰€ã§ã‚„ã£ã¦ã„ã‚‹ã“ã¨ã¯ã€
basePathï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤å…ˆã®Pagesã®URLï¼‰ã‚’ã€`nextConfig`å†…ã«è‡ªå‹•ã§æŒ¿å…¥ã—ã¦ãã‚Œã‚‹ã¨ã„ã†å‡¦ç†ã§ã™ã€‚

è©²å½“ã®Actionsã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã«è¡Œã£ã¦ã€åŸå› ãŒã‚ã‹ã‚Šã¾ã—ãŸï¼š
https://github.com/actions/configure-pages
ï¼ˆä¸Šè¨˜ã‚ˆã‚Šã‚³ãƒ¼ãƒ‰ã‚’å¼•ç”¨ï¼‰
```js
    case 'next':
      // Next does not want a trailing slash
      path = removeTrailingSlash(path)

      return {
        configurationFile: generatorConfigFile || './next.config.js',
        blankConfigurationFile: `${__dirname}/blank-configurations/next.js`,
        properties: {
          // Configure a base path
          basePath: path,

          // Disable server side image optimization too
          // https://nextjs.org/docs/api-reference/next/image#unoptimized
          'experimental.images.unoptimized': true,
          // No longer experimental as of Next.js v12.3.0
          'images.unoptimized': true
        }
      }
```
ä¸Šè¨˜ã§ã¯ã€Next.jsã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«é–¢ã—ã¦ã€
generatorConfigFileã€ã¾ãŸã¯`./next.config.js`ã¨ãªã£ã¦ã„ã¾ã™ã€‚

generatorConfigFileã«é–¢ã—ã¦ã¯ã€[åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«](https://github.com/actions/configure-pages/blob/main/src/context.js#L8)ã«ã¦ã€`generator_config_file`ã®å€¤ã‚’èª­ã¿å–ã£ã¦ã„ã¾ã—ãŸã€‚

ï¼ˆãƒ¡ãƒ¢ï¼šActionsã®å…¥åŠ›ã¯ã€core.getInputã§èª­ã¿å–ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚è©³ã—ãã¯ä¸‹è¨˜ã‚’å‚ç…§ï¼‰
https://github.com/actions/toolkit/tree/master/packages/core

**ã¤ã¾ã‚Šã€`Setup Pages`å†…éƒ¨ã¯æ¬¡ã®ã‚ˆã†ãªå‡¦ç†ã«ãªã£ã¦ã„ã¾ã—ãŸï¼š**
- `generator_config_file`ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚Œã°ã€ãã‚Œã‚’è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦æ¤œå‡ºã—ã€ãã“ã«basePathã«é–¢ã™ã‚‹æƒ…å ±ã‚’æ›¸ãè¾¼ã‚€ã€‚
- ã‚‚ã—ã€ä½•ã‚‚æŒ‡å®šã•ã‚Œã¦ã„ãªã‘ã‚Œã°ã€`./next.config.js`ã«æ›¸ãè¾¼ã‚€ã€‚

`create-next-app`ã§ã¯ã€`next.config.mjs`ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ä½œæˆã•ã‚Œã¾ã™ã€‚

ãªã®ã§ã€next.config.mjs ã®å ´åˆã¯ã€ä¸‹è¨˜ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ãªã„ã¨ã„ã‘ã¾ã›ã‚“ã€‚
```
generator_config_file: next.config.mjs
```

**ã“ã®æŒ‡å®šã‚’ã—ãªã„ã¨ã€next.config.mjsãŒã‚ã‚‹ã®ã«ã€next.config.jsãŒä½œæˆã•ã‚Œã¦ã—ã¾ã„ã€å…ƒã®next.config.mjsã®å†…å®¹ãŒåæ˜ ã•ã‚Œãªããªã‚Šã¾ã™ï¼**

ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’ä½¿ã†éš›ã¯ã€ã¡ã‚ƒã‚“ã¨èª¿ã¹ã‚‹ã“ã¨ãŒå¤§åˆ‡ã§ã™ã­ï¼


## ãŠã‚ã‚Šã«

æœ€å¾Œã¾ã§èª­ã‚“ã§ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ğŸ¸

ç¾æ™‚ç‚¹ï¼ˆNext.js V14.1.3ï¼‰ã§ã¯ã€**`create-next-app`ã§ã€`next.config.mjs`ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ä½œæˆã•ã‚Œã‚‹ã®ã§ã€Actionsã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å¤‰æ›´ã«ã¯ã€æ³¨æ„ãŒå¿…è¦ã§ã™ã­ï¼**

æ°—ãŒã¤ã„ãŸã‚‰çµæ§‹é•·ããªã£ã¦ã„ã¾ã—ãŸãŒã€
ãœã²ã€GitHub Pagesã§ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ï¼

Happy Hacking !

## å‚è€ƒ
https://zenn.dev/pino0701/articles/nextjs_github_pages
https://stackoverflow.com/questions/77933974/how-to-deploy-nextjs-app-with-githup-actions